#BEFORE STARTING OUR CLASS, PLEASE RUN THIS SNIPPET TO INSTALL/LOAD OUR LIBRARIES NEEDED FOR THIS LESSON

packages_needed <- c('car', 'reshape2', 'HH', 'lme4')
for (package_name in packages_needed) {      
  if (!(package_name %in% rownames(installed.packages()))){
    install.packages(package_name)
  }
}
for (i in 1:length(packages_needed))
{
  library(packages_needed[[i]],character.only=TRUE)
}



######################################################################################################
######################################################################################################


#Preparing the dataset for the two-way anova
Gender <- rep(c(rep('m',10),rep('f',10)),4)
m.hemo_2 <- data.frame(m.hemo,Gender)

group = m.hemo_2$Group
#Two way anova without error
aov.two<- aov(m.hemo_2$Bloodlv~group * m.hemo_2$Gender,data =m.hemo_2)

#checking the result of the anova
summary(aov.two)

#lets see the confidence intervals generated by the anova
confint(aov.two, level = 0.90)
#some interesting plots for anova
plot(aov.two)

#tukey post hoc
post_hoc.two <- TukeyHSD(aov.two, 'm.hemo_2$Group', conf.level =0.95)
post_hoc.two


#set the constrasts
options(contrasts = rep ("contr.treatment", 2))


#pairwise confidence

aov.two.pairwise <- mmc(aov.two, linfct = mcp(group = "Tukey"))
aov.two.pairwise
mmcplot(aov.two.pairwise, ylab="Comparison of Levels")